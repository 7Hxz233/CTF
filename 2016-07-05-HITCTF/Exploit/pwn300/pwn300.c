#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int read_input_raw(char *buf, int max_len);
int write_output_raw(char *buf, int len)
{
	write(1,buf,len);
}


int main()
{
	int len;
	char buffer[10] = {0};
	setvbuf(stdout,NULL,_IONBF,0);
	puts("What's your name?");
	len = read_input_raw(buffer,0x40);
	write(1,"hello, ",7);
	write(1,buffer,len);
	write(1,"\n",1);
	
	return 0;
}

int read_input_raw(char *buf,int max_len)
{
	int i=0;
	int sz_read;
	char tmp;
	for (i=0;i<max_len;i++)
	{
		sz_read = read(0,&tmp,1);
		if(sz_read == -1)
			exit(-1);
		if(sz_read == 0)
		{
			break;
		}
		if(sz_read != 1)
			exit(-1);
		if (tmp == '\n' || tmp == '\r')
			break;
		buf[i] = tmp;
	}
	return i;
}

