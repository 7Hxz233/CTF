#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int read_input_raw(char *buf,int max_len);

void do_you_like_me()
{
	char flag[50] = {0};
	FILE *fp = fopen("./flag","r");
	if(fp == NULL)
		exit(-1);
	fread(flag,1,50,fp);
	printf("I know you like me, here is the flag: %s\n",flag);
}


int main()
{
	char buffer[10] = {0};
	setvbuf(stdout,NULL,_IONBF,0);
	puts("What's your name?");
	fflush(stdout);
	read_input_raw(buffer,0x40);
	printf("Hello, %s. Do you like me?\n",buffer);
	fflush(stdout);
	read_input_raw(buffer,0x40);
	puts("Cheater!\n");
	return 0;
}

int read_input_raw(char *buf,int max_len)
{
	int i=0;
	int sz_read;
	char tmp;
	for (i=0;i<max_len;i++)
	{
		sz_read = read(0,&tmp,1);
		if(sz_read == -1)
			exit(-1);
		if(sz_read == 0)
		{
			break;
		}
		if(sz_read != 1)
			exit(-1);
		if (tmp == '\n' || tmp == '\r')
			break;
		buf[i] = tmp;
	}
	return i;
}
